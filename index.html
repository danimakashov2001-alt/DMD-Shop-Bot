<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</title>

<link rel="stylesheet" href="https://unpkg.com/photoswipe@5/dist/photoswipe.css">

<style>
  body, html {
    margin:0; padding:0; width:100%; height:100%;
    font-family:-apple-system,BlinkMacSystemFont,Arial;
    background:#0b0b0b; color:#fff;
  }

  header{
    height:46px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 14px;
    background:#111;
    font-weight:600;
    gap:12px;
  }
  .header-left{
    display:flex;
    align-items:center;
    gap:10px;
    min-width:0;
  }
  .header-title{
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .btn{
    appearance:none;
    border:0;
    padding:8px 12px;
    border-radius:12px;
    background:#1f1f1f;
    color:#fff;
    font-weight:600;
    cursor:pointer;
  }
  .btn:active{ transform:scale(0.98); }

  .page{
    height:calc(100vh - 46px);
    overflow-y:auto;
  }

  /* –¢–æ–≤–∞—Ä—ã */
  .catalog{
    padding:14px;
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
    gap:14px;
  }
  .card{
    background:#fff; color:#000;
    border-radius:16px; overflow:hidden;
    cursor:pointer;
    transition:transform .2s;
  }
  .card:hover{transform:scale(1.03);}
  .card img{width:100%; height:210px; object-fit:cover;}
  .card-body{padding:10px; font-size:13px;}
  .status{color:#c49a6c;}

  /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ */
  .categories{
    padding:14px;
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .cat-card{
    background:#111;
    border:1px solid rgba(255,255,255,0.08);
    border-radius:16px;
    padding:12px 12px 10px;
  }
  .cat-title{
    font-weight:700;
    margin-bottom:10px;
  }
  .subcats{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
  }
  .chip{
    padding:8px 12px;
    border-radius:999px;
    background:#1f1f1f;
    border:1px solid rgba(255,255,255,0.08);
    cursor:pointer;
    user-select:none;
    font-size:13px;
  }
  .chip:active{ transform:scale(0.98); }
  .hint{
    padding:0 14px 14px;
    color:rgba(255,255,255,0.75);
    font-size:12px;
  }

  /* Overlay info (PhotoSwipe) */
  .pswp__custom-info{
    position:absolute; left:0; right:0; bottom:0;
    padding:14px 16px;
    background:linear-gradient(transparent,rgba(0,0,0,.85));
    font-size:13px;
    transition:opacity .2s;
    pointer-events:none;
  }
  .pswp__custom-info.hidden{opacity:0;}
  .pswp__custom-info .price{margin-top:6px; font-weight:600;}

  /* —É—Ç–∏–ª–∏—Ç—ã */
  .hidden{ display:none !important; }
  .empty{
    padding:14px;
    color:rgba(255,255,255,0.8);
    font-size:13px;
  }
</style>
</head>

<body>
<header>
  <div class="header-left">
    <div class="header-title" id="headerTitle">üõç –ö–∞—Ç–∞–ª–æ–≥</div>
  </div>
  <button class="btn" id="toggleBtn">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
</header>

<!-- –≠–∫—Ä–∞–Ω —Ç–æ–≤–∞—Ä–æ–≤ -->
<div class="page" id="productsPage">
  <div class="catalog" id="catalog"></div>
  <div class="empty hidden" id="emptyState">–ü–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –≤ —ç—Ç–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏.</div>
</div>

<!-- –≠–∫—Ä–∞–Ω –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
<div class="page hidden" id="categoriesPage">
  <div class="categories" id="categories"></div>
  <div class="hint">–ù–∞–∂–º–∏ –Ω–∞ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é ‚Äî –ø–æ–∫–∞–∂—É —Ç–æ–≤–∞—Ä—ã.</div>
</div>

<script type="module">
import PhotoSwipeLightbox from 'https://unpkg.com/photoswipe@5/dist/photoswipe-lightbox.esm.min.js';

// ====== –¢–æ–≤–∞—Ä—ã ======
const products = [
  {
    name:"–ó–∏–ø —Ö—É–¥–∏ Zara Type crop fit (—Å–µ—Ä—ã–π)",
    price:4300,
    status:"–í –Ω–∞–ª–∏—á–∏–∏",
    description:"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏: 185/70, —Ä–∞–∑–º–µ—Ä L.",
    subcategory:"zip_hoodies",
    photos:[
      "https://iili.io/fVQvE5F.jpg",
      "https://iili.io/fVQU5WG.jpg",
      "https://iili.io/fVQUMbe.webp",
      "https://iili.io/fVQUv5P.webp"
    ]
  },
  {
    name:"–ó–∏–ø —Ö—É–¥–∏ Zara Type crop fit (—á—ë—Ä–Ω—ã–π)",
    price:4300,
    status:"–í –Ω–∞–ª–∏—á–∏–∏",
    description:"–ú–∏–Ω–∏–º–∞–ª–∏–∑–º. –ü–ª–æ—Ç–Ω—ã–π —Ö–ª–æ–ø–æ–∫.",
    subcategory:"zip_hoodies",
    photos:[
      "https://iili.io/fVQ6E4j.webp",
      "https://iili.io/fVQ6ba4.webp",
      "https://iili.io/fVQPF6b.webp",
      "https://iili.io/fVQPuMg.webp",
      "https://iili.io/fVQP0NI.webp"
    ]
  },
  {
    name:"–ó–∏–ø —Ö—É–¥–∏ No Faith Studio boxy crop fit",
    price:4100,
    status:"–í –Ω–∞–ª–∏—á–∏–∏",
    description:"Y2K / Opium —Å—Ç–∏–ª—å.",
    subcategory:"zip_hoodies",
    photos:[
      "https://iili.io/fXB5Ctj.jpg",
      "https://iili.io/fXqKi8B.webp",
      "https://iili.io/fXqfRte.webp"
    ]
  },
  {
    name:"–õ–æ–Ω–≥—Å–ª–∏–≤ Derschutze crop fit",
    price:3890,
    status:"–í –Ω–∞–ª–∏—á–∏–∏",
    description:"–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è –≤—ã—à–∏–≤–∫–∞.",
    subcategory:"longsleeves",
    photos:[
      "https://iili.io/fVQgdrl.webp",
      "https://iili.io/fVQgbaV.webp",
      "https://iili.io/fVQrMMb.webp",
      "https://iili.io/fVQrkDF.webp",
      "https://iili.io/fVQ4JJ2.webp",
      "https://iili.io/fVQ4I5B.webp"
    ]
  }
];

// ====== –ö–∞—Ç–µ–≥–æ—Ä–∏–∏/–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–∫–∞–∫ —Ç—ã –¥–∞–ª) ======
const categoryTree = [
  { title: "–ì–æ–ª–æ–≤–Ω—ã–µ —É–±–æ—Ä—ã", subs: ["–®–∞–ø–∫–∏", "–ö–µ–ø–∫–∏"] },
  { title: "–í–µ—Ä—Ö", subs: ["–ó–∏–ø –•—É–¥–∏", "–õ–æ–Ω–≥—Å–ª–∏–≤—ã", "–§—É—Ç–±–æ–ª–∫–∏"] },
  { title: "–ù–∏–∑", subs: ["–î–∂–∏–Ω—Å—ã", "–ë—Ä—é–∫–∏", "–®–æ—Ä—Ç—ã"] },
  { title: "–û–±—É–≤—å", subs: ["–ö—Ä–æ—Å—Å–æ–≤–∫–∏", "–¢—É—Ñ–ª–∏"] }
];

// ====== –ú–∞–ø–ø–∏–Ω–≥ –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π ‚Üí –∫–ª—é—á subcategory –≤ —Ç–æ–≤–∞—Ä–∞—Ö ======
// –¥–æ–±–∞–≤–ª—è–π —Å—é–¥–∞ –Ω–æ–≤—ã–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –º–µ—Ä–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞
const subcategoryMap = {
  "–ó–∏–ø –•—É–¥–∏": "zip_hoodies",
  "–õ–æ–Ω–≥—Å–ª–∏–≤—ã": "longsleeves",
  // "–§—É—Ç–±–æ–ª–∫–∏": "tshirts",
  // "–î–∂–∏–Ω—Å—ã": "jeans",
  // "–ë—Ä—é–∫–∏": "pants",
  // "–®–æ—Ä—Ç—ã": "shorts",
  // "–®–∞–ø–∫–∏": "beanies",
  // "–ö–µ–ø–∫–∏": "caps",
  // "–ö—Ä–æ—Å—Å–æ–≤–∫–∏": "sneakers",
  // "–¢—É—Ñ–ª–∏": "shoes"
};

// ====== DOM ======
const headerTitle = document.getElementById("headerTitle");
const toggleBtn = document.getElementById("toggleBtn");

const productsPage = document.getElementById("productsPage");
const categoriesPage = document.getElementById("categoriesPage");

const catalog = document.getElementById("catalog");
const categoriesEl = document.getElementById("categories");
const emptyState = document.getElementById("emptyState");

let currentFilter = null; // null = –≤—Å–µ —Ç–æ–≤–∞—Ä—ã

// ====== –†–µ–Ω–¥–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤ ======
function renderProducts() {
  catalog.innerHTML = "";
  emptyState.classList.add("hidden");

  const list = currentFilter
    ? products.filter(p => p.subcategory === currentFilter)
    : products;

  if (list.length === 0) {
    emptyState.classList.remove("hidden");
    return;
  }

  list.forEach((product) => {
    const card = document.createElement("div");
    card.className = "card";
    card.dataset.subcategory = product.subcategory;
    card.innerHTML = `
      <img src="${product.photos[0]}" alt="">
      <div class="card-body">
        ${product.name}<br>
        <span class="status">${product.status}</span><br>
        ${product.price}
      </div>
    `;
    // –≤–∞–∂–Ω–æ: —Ö—Ä–∞–Ω–∏–º —Å—Å—ã–ª–∫—É –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç –ø—Ä—è–º–æ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
    card.__product = product;
    catalog.appendChild(card);
  });
}

// ====== –†–µ–Ω–¥–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π ======
function renderCategories() {
  categoriesEl.innerHTML = "";
  categoryTree.forEach(cat => {
    const wrap = document.createElement("div");
    wrap.className = "cat-card";
    wrap.innerHTML = `<div class="cat-title">${cat.title}</div>`;

    const subs = document.createElement("div");
    subs.className = "subcats";

    cat.subs.forEach(subName => {
      const chip = document.createElement("div");
      chip.className = "chip";
      chip.textContent = subName;
      chip.dataset.subname = subName;
      subs.appendChild(chip);
    });

    wrap.appendChild(subs);
    categoriesEl.appendChild(wrap);
  });
}

// ====== –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–æ–≤ ======
function openCategories() {
  productsPage.classList.add("hidden");
  categoriesPage.classList.remove("hidden");
  toggleBtn.textContent = "–ù–∞–∑–∞–¥";
  headerTitle.textContent = "üìö –ö–∞—Ç–µ–≥–æ—Ä–∏–∏";
}

function closeCategories() {
  categoriesPage.classList.add("hidden");
  productsPage.classList.remove("hidden");
  toggleBtn.textContent = "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏";
  headerTitle.textContent = currentFilter ? "üõç –ö–∞—Ç–∞–ª–æ–≥ ‚Ä¢ —Ñ–∏–ª—å—Ç—Ä" : "üõç –ö–∞—Ç–∞–ª–æ–≥";
}

toggleBtn.addEventListener("click", () => {
  const isCategoriesOpen = !categoriesPage.classList.contains("hidden");
  if (isCategoriesOpen) closeCategories();
  else openCategories();
});

// ====== –ö–ª–∏–∫ –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ======
categoriesEl.addEventListener("click", (e) => {
  const chip = e.target.closest(".chip");
  if (!chip) return;

  const subName = chip.dataset.subname;
  const mapped = subcategoryMap[subName];

  // –µ—Å–ª–∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è –µ—â—ë –Ω–µ –∑–∞–º–∞–ø–ª–µ–Ω–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∂–µ–º –ø—É—Å—Ç–æ (–∏–ª–∏ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å "–≤—Å–µ")
  currentFilter = mapped || "__none__";

  renderProducts();
  closeCategories();
});

// ====== PhotoSwipe ======
let currentProduct = null;

const lightbox = new PhotoSwipeLightbox({
  pswpModule: () => import('https://unpkg.com/photoswipe@5/dist/photoswipe.esm.min.js'),
  wheelToZoom: true,
  arrowKeys: true
});

lightbox.on('uiRegister', () => {
  lightbox.pswp.ui.registerElement({
    name: 'custom-info',
    order: 9,
    isButton: false,
    appendTo: 'root',
    html: `
      <div class="pswp__custom-info" id="pswp-info">
        <b id="pswp-name"></b><br>
        <span id="pswp-desc"></span><br>
        <span id="pswp-status"></span>
        <div class="price" id="pswp-price"></div>
      </div>
    `
  });
});

function updateOverlay(product) {
  const nameEl = document.getElementById('pswp-name');
  const descEl = document.getElementById('pswp-desc');
  const statusEl = document.getElementById('pswp-status');
  const priceEl = document.getElementById('pswp-price');
  if (!nameEl) return;

  nameEl.textContent = product?.name ?? '';
  descEl.textContent = product?.description ?? '';
  statusEl.textContent = product?.status ?? '';
  priceEl.textContent = product?.price != null ? String(product.price) : '';
}

lightbox.on('open', () => {
  const pswp = lightbox.pswp;

  updateOverlay(currentProduct);

  pswp.on('zoomPanUpdate', (e) => {
    const info = document.getElementById("pswp-info");
    if (info) info.classList.toggle('hidden', e.scale > 1);
  });

  pswp.on('doubleTap', () => {
    const scale = pswp.currZoomLevel > 1 ? 1 : 2;
    pswp.zoomTo(scale, { x: pswp.viewportSize.x/2, y: pswp.viewportSize.y/2 });
  });
});

lightbox.init();

// ====== –ö–ª–∏–∫ –ø–æ —Ç–æ–≤–∞—Ä—É (–æ—Ç–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é) ======
catalog.addEventListener("click", (e) => {
  const card = e.target.closest(".card");
  if (!card) return;

  const product = card.__product;
  if (!product) return;

  currentProduct = product;

  const items = product.photos.map((src) => ({
    src,
    width: 1600,
    height: 2000
  }));

  lightbox.loadAndOpen(0, items);
});

// init
renderProducts();
renderCategories();
</script>

</body>
</html>
