<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</title>

<link rel="stylesheet" href="https://unpkg.com/photoswipe@5/dist/photoswipe.css">

<style>
  body, html {
    margin:0; padding:0; width:100%; height:100%;
    font-family:-apple-system,BlinkMacSystemFont,Arial;
    background:#0b0b0b; color:#fff;
  }
  header{
    height:46px; display:flex; align-items:center; padding:0 14px; background:#111; font-weight:600;
  }
  .catalog{
    height:calc(100vh - 46px); overflow-y:auto; padding:14px;
    display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:14px;
  }
  .card{
    background:#fff; color:#000; border-radius:16px; overflow:hidden; cursor:pointer; transition:transform .2s;
  }
  .card:hover{transform:scale(1.03);}
  .card img{width:100%; height:210px; object-fit:cover;}
  .card-body{padding:10px; font-size:13px;}
  .status{color:#c49a6c;}

  /* Overlay info */
  .pswp__custom-info{
    position:absolute; left:0; right:0; bottom:0;
    padding:14px 16px;
    background:linear-gradient(transparent,rgba(0,0,0,.85));
    font-size:13px;
    transition:opacity .2s;
    pointer-events:none; /* —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞–ª–æ –∂–µ—Å—Ç–∞–º */
  }
  .pswp__custom-info.hidden{opacity:0;}
  .pswp__custom-info .price{margin-top:6px; font-weight:600;}
</style>
</head>

<body>
<header>üõç –ö–∞—Ç–∞–ª–æ–≥</header>
<div class="catalog" id="catalog"></div>

<script type="module">
import PhotoSwipeLightbox from 'https://unpkg.com/photoswipe@5/dist/photoswipe-lightbox.esm.min.js';

// ====== –ú–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤ ======
const products = [
  {
    name:"–ó–∏–ø —Ö—É–¥–∏ Zara Type crop fit (—Å–µ—Ä—ã–π)",
    price:4300,
    status:"–í –Ω–∞–ª–∏—á–∏–∏",
    description:"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏: 185/70, —Ä–∞–∑–º–µ—Ä L.",
    subcategory:"zip_hoodies",
    photos:[
      "https://iili.io/fVQvE5F.jpg",
      "https://iili.io/fVQU5WG.jpg",
      "https://iili.io/fVQUMbe.webp",
      "https://iili.io/fVQUv5P.webp"
    ]
  },
  {
    name:"–ó–∏–ø —Ö—É–¥–∏ Zara Type crop fit (—á—ë—Ä–Ω—ã–π)",
    price:4300,
    status:"–í –Ω–∞–ª–∏—á–∏–∏",
    description:"–ú–∏–Ω–∏–º–∞–ª–∏–∑–º. –ü–ª–æ—Ç–Ω—ã–π —Ö–ª–æ–ø–æ–∫.",
    subcategory:"zip_hoodies",
    photos:[
      "https://iili.io/fVQ6E4j.webp",
      "https://iili.io/fVQ6ba4.webp",
      "https://iili.io/fVQPF6b.webp",
      "https://iili.io/fVQPuMg.webp",
      "https://iili.io/fVQP0NI.webp"
    ]
  },
  {
    name:"–ó–∏–ø —Ö—É–¥–∏ No Faith Studio boxy crop fit",
    price:4100,
    status:"–í –Ω–∞–ª–∏—á–∏–∏",
    description:"Y2K / Opium —Å—Ç–∏–ª—å.",
    subcategory:"zip_hoodies",
    photos:[
      "https://iili.io/fXB5Ctj.jpg",
      "https://iili.io/fXqKi8B.webp",
      "https://iili.io/fXqfRte.webp"
    ]
  },
  {
    name:"–õ–æ–Ω–≥—Å–ª–∏–≤ Derschutze crop fit",
    price:3890,
    status:"–í –Ω–∞–ª–∏—á–∏–∏",
    description:"–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è –≤—ã—à–∏–≤–∫–∞.",
    subcategory:"longsleeves",
    photos:[
      "https://iili.io/fVQgdrl.webp",
      "https://iili.io/fVQgbaV.webp",
      "https://iili.io/fVQrMMb.webp",
      "https://iili.io/fVQrkDF.webp",
      "https://iili.io/fVQ4JJ2.webp",
      "https://iili.io/fVQ4I5B.webp"
    ]
  }
];

// ====== –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–∞–ª–æ–≥ ======
const catalog = document.getElementById("catalog");

products.forEach((product) => {
  const card = document.createElement("div");
  card.className = "card";
  card.innerHTML = `
    <img src="${product.photos[0]}" alt="">
    <div class="card-body">
      ${product.name}<br>
      <span class="status">${product.status}</span><br>
      ${product.price}
    </div>
  `;
  catalog.appendChild(card);
});

// ====== Lightbox ======
let currentProduct = null;

// –í–ê–ñ–ù–û: –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –¥–∞—Ç—å pswpModule –∫–∞–∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç
const lightbox = new PhotoSwipeLightbox({
  pswpModule: () => import('https://unpkg.com/photoswipe@5/dist/photoswipe.esm.min.js'),
  wheelToZoom: true,
  arrowKeys: true
});

// –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–π UI –æ–¥–∏–Ω —Ä–∞–∑
lightbox.on('uiRegister', () => {
  lightbox.pswp.ui.registerElement({
    name: 'custom-info',
    order: 9,
    isButton: false,
    appendTo: 'root',
    html: `
      <div class="pswp__custom-info" id="pswp-info">
        <b id="pswp-name"></b><br>
        <span id="pswp-desc"></span><br>
        <span id="pswp-status"></span>
        <div class="price" id="pswp-price"></div>
      </div>
    `
  });
});

function updateOverlay(product) {
  const nameEl = document.getElementById('pswp-name');
  const descEl = document.getElementById('pswp-desc');
  const statusEl = document.getElementById('pswp-status');
  const priceEl = document.getElementById('pswp-price');

  if (!nameEl) return;

  nameEl.textContent = product?.name ?? '';
  descEl.textContent = product?.description ?? '';
  statusEl.textContent = product?.status ?? '';
  priceEl.textContent = product?.price != null ? String(product.price) : '';
}

lightbox.on('open', () => {
  const pswp = lightbox.pswp;

  // –Ω–∞–ø–æ–ª–Ω—è–µ–º –æ–≤–µ—Ä–ª–µ–π –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
  updateOverlay(currentProduct);

  // —Å–∫—Ä—ã–≤–∞–µ–º overlay –ø—Ä–∏ –∑—É–º–µ
  pswp.on('zoomPanUpdate', (e) => {
    const info = document.getElementById("pswp-info");
    if (info) info.classList.toggle('hidden', e.scale > 1);
  });

  // double tap zoom (–Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö)
  pswp.on('doubleTap', () => {
    const scale = pswp.currZoomLevel > 1 ? 1 : 2;
    pswp.zoomTo(scale, { x: pswp.viewportSize.x/2, y: pswp.viewportSize.y/2 });
  });
});

lightbox.init();

// ====== –ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ ======
catalog.addEventListener("click", (e) => {
  const card = e.target.closest(".card");
  if (!card) return;

  const index = Array.from(catalog.children).indexOf(card);
  currentProduct = products[index];

  const items = currentProduct.photos.map((src) => ({
    src,
    width: 1600,
    height: 2000
  }));

  // ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ô –í–´–ó–û–í: (index, dataSource)
  lightbox.loadAndOpen(0, items);
});
</script>

</body>
</html>
